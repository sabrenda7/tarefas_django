{% extends 'projetos/base.html' %}
{% block title %}Tarefas{% endblock %}

{% block content %}
<h2>ğŸ“ {{ projeto.nome }}</h2>

<a href="{% url 'nova_tarefa' projeto.id %}" class="btn btn-primary mb-3">
    + Nova Tarefa
</a>

<ul class="list-group">
    {% for tarefa in tarefas %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
            <strong>{{ tarefa.titulo }}</strong><br>

            {# --- Badge visual do status --- #}
            {% if tarefa.status == 'C' %}
                <span class="badge bg-success">âœ… {{ tarefa.get_status_display }}</span>
            {% elif tarefa.status == 'E' %}
                <span class="badge bg-warning text-dark">â³ {{ tarefa.get_status_display }}</span>
            {% else %}
                <span class="badge bg-secondary">ğŸ“Œ {{ tarefa.get_status_display }}</span>
            {% endif %}

            {# --- Data de entrega --- #}
            {% if tarefa.data_entrega %}
                <br>
                <small class="text-muted">
                    ğŸ“… Entrega: {{ tarefa.data_entrega|date:"d/m/Y" }}
                </small>
            {% endif %}
        </div>

        {# --- BotÃ£o inteligente --- #}
        <a href="{% url 'editar_tarefa' tarefa.id %}"
           class="btn btn-sm
           {% if tarefa.status == 'P' %}btn-outline-secondary
           {% elif tarefa.status == 'E' %}btn-outline-warning
           {% else %}btn-outline-success{% endif %}">
            {% if tarefa.status == 'C' %}âœ…{% elif tarefa.status == 'E' %}â³{% else %}ğŸ“Œ{% endif %}
            AvanÃ§ar status
        </a>
    </li>

    {% empty %}
    <li class="list-group-item text-muted">
        Nenhuma tarefa cadastrada.
    </li>
    {% endfor %}
</ul>

<a href="{% url 'lista_projetos' %}" class="btn btn-link mt-3">
    â† Voltar para projetos
</a>
{% endblock %}